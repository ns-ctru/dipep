#### Raw Data

The raw data is summarised below.  This is *before* applying any rules such as "*if a Yes/No response is not present assume No*", the pattern of missing data after applying these rules is presented in the next tab (Tidied Data).  The first set of tables summarise for each 'set' of variables (physiology, medical history, this pregnanyc and previous pregnancy) how many individuals in each group the number of these which are missing.

**NB** If there is a level of missing observations that is not present in the data it is NOT present in the table.

```{r missing_data_raw_physiology, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
options(knitr.kable.NA = 0)
dipep_incomplete(df = dipep.raw,
                 id = screening,
                 age, bmi, heart.rate, respiratory.rate, bp.systolic, bp.diastolic, temperature, o2.saturation) %>%
  dipep_table_prop(df = ., rows = 'group', columns = 'n_missing', prop.by = 'rows', percent = TRUE) %>%
  kable(caption = paste0('Number of missing physiological variables (Age, BMI, Heart Rate, Respiratory Rate, Systolic Blood Pressure, Diastolic Blood Pressure, Temperature and O2 Saturation) by group', 'Generated : ', Sys.time()))

```

```{r missing_data_raw_medical_history, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
options(knitr.kable.NA = 0)
dipep_incomplete(df = dipep.raw,
                 id = screening,
                 history.thrombosis, history.veins, history.iv.drug, thrombo, surgery, injury, thrombosis) %>%
  dipep_table_prop(df = ., rows = 'group', columns = 'n_missing', prop.by = 'rows', percent = TRUE) %>%
kable(caption = paste0('Number of missing medical history variables (History of Thrombosis in Relatives, History of Varicose Veins, History of IV Drug use, Known Thrombophilia, Surgery <= 4 weeks, Injury <= 4 weeks, History of Thrombosis) by group', 'Generated : ', Sys.time()))

```

```{r missing_data_raw_this_pregnancy, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
options(knitr.kable.NA = 0)
dipep_incomplete(df = dipep.raw,
                 id = screening,
                 multiple.preg, travel, immobil) %>%
  dipep_table_prop(df = ., rows = 'group', columns = 'n_missing', prop.by = 'rows', percent = TRUE) %>%
  kable(caption = paste0('Number of missing variables for this pregnancy (Multiple Pregnancy, >= 4hrs travel during pregnancy, >= 3 days immobility) by group.', 'Generated : ', Sys.time()))

```

```{r missing_data_raw_previous_pregnancy, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
options(knitr.kable.NA = 0)
dipep_incomplete(df = dipep.raw,
                 id = screening,
                 pregnancies.over, pregnancies.under, prev.preg.problem) %>%
  dipep_table_prop(df = ., rows = 'group', columns = 'n_missing', prop.by = 'rows', percent = TRUE) %>%
  kable(caption = paste0('Number of missing variables for previous pregnancies (if any) (Previous Pregnancies >= 24 weeks, Previous Pregnancies <= 24 weeks, Previous Pregnancy Problems) by group.', 'Generated : ', Sys.time()))

```


```{r missing_data_raw_summary, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
## Count the number of observations of each
n.diagnosed.dvt <- filter(dipep.raw, group == 'Diagnosed DVT') %>%
                   nrow()
n.non.recruited <- filter(dipep.raw, group == 'Non recruited') %>%
                   nrow()
n.suspected.pe  <- filter(dipep.raw, group == 'Suspected PE') %>%
                   nrow()
missing <-  group_by(dipep.raw, group) %>%
            summarise_each(funs(sum(is.na(.)))) %>%
            t() %>%
            as.data.frame()
names(missing) <- c(paste0('Diagnosed DVT (N = ', n.diagnosed.dvt, ')'),
                    paste0('Non recruited (N = ', n.non.recruited, ')'),
                    paste0('Suspected PE (N = ', n.suspected.pe, ')'))
missing[!rownames(missing) %in% 'group',] %>%
    kable(caption = paste0('Missing data patterns in raw data for variables used in statistical modelling.\n', 'Generated : ', Sys.time()))
rm(n.diagnosed.dvt, n.non.recruited, n.suspected.pe, missing)

```


#### Tidied Data

The rawtidied data is summarised below.  This is *after* applying any rules such as "*if a Yes/No response is not present assume No*", the pattern of missing data before applying these rules is presented in the previous tab (Raw Data).  The first set of tables summarise for each 'set' of variables (physiology, medical history, this pregnanyc and previous pregnancy) how many individuals in each group the number of these which are missing.

**NB** If there is a level of missing observations that is not present in the data it is NOT present in the table.

```{r missing_data_tidy_physiology, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
options(knitr.kable.NA = 0)
dipep_incomplete(df = dipep,
                 id = screening,
                 age, bmi, heart.rate, respiratory.rate, bp.systolic, bp.diastolic, temperature, o2.saturation) %>%
  dipep_table_prop(df = ., rows = 'group', columns = 'n_missing', prop.by = 'rows', percent = TRUE) %>%
  kable(caption = paste0('Number of missing physiological variables (Age, BMI, Heart Rate, Respiratory Rate, Systolic Blood Pressure, Diastolic Blood Pressure, Temperature and O2 Saturation) by group', 'Generated : ', Sys.time()))

```

```{r missing_data_tidy_medical_history, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
options(knitr.kable.NA = 0)
dipep_incomplete(df = dipep,
                 id = screening,
                 history.thrombosis, history.veins, history.iv.drug, thrombo, surgery, injury, thrombosis) %>%
  dipep_table_prop(df = ., rows = 'group', columns = 'n_missing', prop.by = 'rows', percent = TRUE) %>%
  kable(caption = paste0('Number of missing medical history variables (History of Thrombosis in Relatives, History of Varicose Veins, History of IV Drug use, Known Thrombophilia, Surgery <= 4 weeks, Injury <= 4 weeks, History of Thrombosis) by group', 'Generated : ', Sys.time()))

```

```{r missing_data_tidy_this_pregnancy, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
options(knitr.kable.NA = 0)
dipep_incomplete(df = dipep,
                 id = screening,
                 multiple.preg, travel, immobil) %>%
  dipep_table_prop(df = ., rows = 'group', columns = 'n_missing', prop.by = 'rows', percent = TRUE) %>%
  kable(caption = paste0('Number of missing variables for this pregnancy (Multiple Pregnancy, >= 4hrs travel during pregnancy, >= 3 days immobility) by group.', 'Generated : ', Sys.time()))

```

```{r missing_data_tidy_previous_pregnancy, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
options(knitr.kable.NA = 0)
dipep_incomplete(df = dipep,
                 id = screening,
                 pregnancies.over, pregnancies.under, prev.preg.problem) %>%
  dipep_table_prop(df = ., rows = 'group', columns = 'n_missing', prop.by = 'rows', percent = TRUE) %>%
  kable(caption = paste0('Number of missing variables for previous pregnancies (if any) (Previous Pregnancies >= 24 weeks, Previous Pregnancies <= 24 weeks, Previous Pregnancy Problems) by group.', 'Generated : ', Sys.time()))

```


```{r missing_data_tidy_summary, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
## Count the number of observations of each
n.diagnosed.dvt <- filter(dipep, group == 'Diagnosed DVT') %>%
                   nrow()
n.non.recruited <- filter(dipep, group == 'Non recruited') %>%
                   nrow()
n.suspected.pe  <- filter(dipep, group == 'Suspected PE') %>%
                   nrow()
missing <-  group_by(dipep, group) %>%
            summarise_each(funs(sum(is.na(.)))) %>%
            t() %>%
            as.data.frame()
names(missing) <- c(paste0('Diagnosed DVT (N = ', n.diagnosed.dvt, ')'),
                    paste0('Non recruited (N = ', n.non.recruited, ')'),
                    paste0('Suspected PE (N = ', n.suspected.pe, ')'))
missing[!rownames(missing) %in% 'group',] %>%
    kable(caption = paste0('Missing data patterns in raw data for variables used in statistical modelling.\n', 'Generated : ', Sys.time()))
rm(n.diagnosed.dvt, n.non.recruited, n.suspected.pe, missing)

```

```{r missing_data_individuals, echo = FALSE, cache = FALSE, results = 'markup', eval = FALSE}
dplyr::select(master$missing, screening, group, site) %>%
    kable(caption = paste0('Individuals with recorded screening, but missing data for womans details and other forms.', 'Generated : ', Sys.time()))

```
