```{r results_existing_logistic, , echo = FALSE, cache = FALSE, warning = FALSE, message = FALSE, fig.height = 10, fig.width = 10, results = 'rmarkdown', eval = TRUE}
## Treating existing scores as continuous variables (bad idea as they are not!) and
## univariable logistic regression of all components of the existing scores have
## been requested.  These are performed here and results presented under each section.
##
## Continuous variable ROC plots...
simplified <- dipep_existing_sum(df                    = dipep,
                                 title                 = 'Simplified Revised Geneva',
                                 exclude               = NULL,
                                 exclude.non.recruited = TRUE,
                                 exclude.dvt           = TRUE,
                                 exclude.missing       = TRUE,
                                 first.st, simplified.pe, simplified)
wells.permissive <- dipep_existing_sum(df                    = dipep,
                                 title                 = 'Wells Score (Permissive)',
                                 exclude               = NULL,
                                 exclude.non.recruited = TRUE,
                                 exclude.dvt           = TRUE,
                                 exclude.missing       = TRUE,
                                 first.st, wells.permissive.pe, wells.permissive)
wells.strict <- dipep_existing_sum(df                    = dipep,
                                 title                 = 'Wells Score (Strict)',
                                 exclude               = NULL,
                                 exclude.non.recruited = TRUE,
                                 exclude.dvt           = TRUE,
                                 exclude.missing       = TRUE,
                                 first.st, wells.strict.pe, wells.strict)
perc <- dipep_existing_sum(df                    = dipep,
                                 title                 = 'PERC Score',
                                 exclude               = NULL,
                                 exclude.non.recruited = TRUE,
                                 exclude.dvt           = TRUE,
                                 exclude.missing       = TRUE,
                                 first.st, perc.pe, perc)
delphi.primary <- dipep_existing_sum(df                    = dipep,
                                 title                 = 'Delphi Primary Score',
                                 exclude               = NULL,
                                 exclude.non.recruited = TRUE,
                                 exclude.dvt           = TRUE,
                                 exclude.missing       = TRUE,
                                 first.st, delphi.primary.pe, delphi.primary)
delphi.sensitivity <- dipep_existing_sum(df                    = dipep,
                                 title                 = 'Delphi Sensitivity Score',
                                 exclude               = NULL,
                                 exclude.non.recruited = TRUE,
                                 exclude.dvt           = TRUE,
                                 exclude.missing       = TRUE,
                                 first.st, delphi.sensitivity.pe, delphi.sensitivity)
delphi.specificity <- dipep_existing_sum(df                    = dipep,
                                 title                 = 'Delphi Specificity Score',
                                 exclude               = NULL,
                                 exclude.non.recruited = TRUE,
                                 exclude.dvt           = TRUE,
                                 exclude.missing       = TRUE,
                                 first.st, delphi.specificity.pe, delphi.specificity)


```


```{r results_existing_logistic_components, , echo = FALSE, cache = FALSE, warning = FALSE, message = FALSE, fig.height = 10, fig.width = 10, results = 'rmarkdown', eval = TRUE}
existing <- list()
existing$simplified.age <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'simplified.age',
                                     model                 = 'Geneva - Age (> )',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
existing$simplified..prev.dvt.pe <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'simplified.prev.dvt.pe',
                                     model                 = 'Geneva - Previous DVT/PE',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
existing$simplified.surgery <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'simplified.surgery',
                                     model                 = 'Geneva - Surgery',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
existing$simplified.neoplasm <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'simplified.neoplasm',
                                     model                 = 'Geneva - Neoplasm',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
existing$simplified.lower.limb.unilateral.pain <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'simplified.lower.limb.unilateral.pain',
                                     model                 = 'Geneva - Lower Limb Unilateral Pain',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
existing$simplified.haemoptysis <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'simplified.haemoptysis',
                                     model                 = 'Geneva - Haemoptysis',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
existing$simplified.heart.rate <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'simplified.heart.rate',
                                     model                 = 'Geneva - Heart Rate',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
existing$simplified.pain.palpitations <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'simplified.pain.palpitations',
                                     model                 = 'Geneva - Pain on Palpitation of Lower Limb',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$perc.age <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'perc.age',
                                     model                 = 'PERC - Age',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$perc.heart.rate <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'perc.heart.rate',
                                     model                 = 'PERC - Heart Rate',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$perc.o2 <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'perc.o2',
                                     model                 = 'PERC - O2 Saturation',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$perc.prev.dvt.pe <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'perc.prev.dvt.pe',
                                     model                 = 'PERC - Previous DVT/PE',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$perc.surgery <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'perc.surgery',
                                     model                 = 'PERC - Surgery',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$perc.haemoptysis <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'perc.haemoptysis',
                                     model                 = 'PERC - Haemoptysis',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$perc.hormone <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'perc.hormone',
                                     model                 = 'PERC - Hormone',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$perc.leg.swelling <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'perc.leg.swelling',
                                     model                 = 'PERC - Leg Swelling',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$wells.dvt <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'wells.dvt',
                                     model                 = 'Wells - DVT',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$wells.alternative.permissive <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'wells.alternative.permissive',
                                     model                 = 'Wells - PE mostly likely diagnosis (Permissive)',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$wells.alternative.strict <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'wells.alternative.strict',
                                     model                 = 'Wells - PE mostly likely diagnosis (Strict)',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$wells.heart.rate <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'wells.heart.rate',
                                     model                 = 'Wells - Heart Rate',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$wells.surgery.immobil <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'wells.surgery.immobil',
                                     model                 = 'Wells - Surgery/Immobility',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$wells.dvt.pe <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'wells.dvt.pe',
                                     model                 = 'Wells - DVT/PE',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$wells.haemoptysis <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'wells.haemoptysis',
                                     model                 = 'Wells - Haemoptysis',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$wells.neoplasm <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'wells.neoplasm',
                                     model                 = 'Wells - Neoplasm',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.haemoptysis <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.haemoptysis',
                                     model                 = 'Delphi - Haemoptysis',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.pleuritic <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.pleuritic',
                                     model                 = 'Delphi - Pleuritic',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.history.dvt.pe <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.history.dvt.pe',
                                     model                 = 'Delphi - History of DVT/PE',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.family.history <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.family.history',
                                     model                 = 'Delphi - Family History',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.medical.history <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.medical.history',
                                     model                 = 'Delphi - Medical History',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.obstetric.complication <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.obstetric.complication',
                                     model                 = 'Delphi - Obstetric Complication',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.medical.complication <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.medical.complication',
                                     model                 = 'Delphi - Medical Complication',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.gestation <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.gestation',
                                     model                 = 'Delphi - Gestation',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.bmi <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.bmi',
                                     model                 = 'Delphi - BMI',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.dvt <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.dvt',
                                     model                 = 'Delphi - DVT',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.o2.saturation <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.o2.saturation',
                                     model                 = 'Delphi - O2 Saturation',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.heart.rate <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.heart.rate',
                                     model                 = 'Delphi - Heart Rate',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)
exisiting$delphi.respiratory.rate <- dipep_glm(df                    = dipep,
                                     classification        = 'first.st',
                                     predictor             = 'delphi.respiratory.rate',
                                     model                 = 'Delphi - Respiratory Rate',
                                     exclude               = NULL,
                                     exclude.dvt           = TRUE,
                                     exclude.non.recruited = TRUE,
                                     exclude.missing       = FALSE)




```
